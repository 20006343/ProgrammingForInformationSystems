<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Owner</title>

     <link rel="stylesheet" href="{{ url_for('static', filename='css/vendor.bundle.base.css') }}?v=0.0.1">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/select2.min.css') }}?v=0.0.1">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/select2-bootstrap.min.css') }}?v=0.0.1">
     <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}?v=0.0.2">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">



  </head>
  <body>
    <div class="container-scroller">
      <div class="">
       
        <nav class="navbar col-lg-12 col-12 p-lg-0 fixed-top d-flex flex-row">
          <div class="navbar-menu-wrapper d-flex align-items-stretch justify-content-between">
            <a class="navbar-brand brand-logo align-self-center d-lg-none" href="../../index.html"><img src="../../assets/images/logo.svg" alt="logo" /></a>
            <button class="navbar-toggler navbar-toggler align-self-center mr-2" type="button" data-toggle="minimize">
              <i class="mdi mdi-menu"></i>
            </button>
            <ul class="navbar-nav">
             

              
            </ul>

            <ul class="navbar-nav navbar-nav-right ml-lg-auto">
              <li class="nav-item">
                <a class="nav-link" onclick="scrolltodiv('userinfo')">
                  <span class="profile-name">Users</span>
                </a>
                
              </li>

              <li class="nav-item">
                <a class="nav-link" onclick="scrolltodiv('employeeinfo')">
                  <span class="profile-name">Employees</span>
                </a>
                
              </li>


        
              <li class="nav-item nav-profile dropdown border-0">
                <a class="nav-link dropdown-toggle" id="profileDropdown" href="#" data-toggle="dropdown">
                  <img class="nav-profile-img mr-2" alt="" src="../../assets/images/faces/face1.jpg" />
                  <span class="profile-name">Owner</span>
                </a>
                <div class="dropdown-menu navbar-dropdown w-100" aria-labelledby="profileDropdown">
                  <a class="dropdown-item" href="/logout">
                    <i class="mdi mdi-logout mr-2 text-primary"></i> Signout </a>
                </div>
              </li>
            </ul>
            <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button" data-toggle="offcanvas">
              <span class="mdi mdi-menu"></span>
            </button>
          </div>
        </nav>
        <div class="main-panel">
          <div class="content-wrapper" >
            <div class="page-header" id="pageheader">
              <h3 class="page-title">Welcome To Your Store</h3>
              <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="#">Store Administration</a></li>
                  <li class="breadcrumb-item active" aria-current="page"> Add / Delete / Update Information</li>
                </ol>
              </nav>
            </div>


            <div class="row" style="overflow-y: scroll;height: 100vh;" id="infocontainer">
              <div class="col-md-12" id="userinfo">
                <div class="row">

                  <div class="col-md-4 grid-margin stretch-card">
                    <div class="card">
                      <div class="card-body">
                        <h4 class="card-title">Users Information</h4>
                        <hr>
                        <p class="card-description">Add User</p>
                       <!--  <p id="userlog" style="color: red">{{session['erroruser']}}</p>
                         <p id="usersuc" style="color: green">{{session['successuser']}}</p> -->
                        <form class="forms-sample">
                          <div class="form-group">
                            <label for="exampleInputUsername1">Username</label>
                            <input type="text" class="form-control" id="username" placeholder="Username" value="" />
                          </div>
                          <div class="form-group">
                            <label for="exampleInputEmail1">password</label>
                            <input type="password" class="form-control" id="password" placeholder="password" value=""/>
                          </div>
                          <div class="form-group">
                            <label for="exampleInputConfirmPassword1">Confirm Password</label>
                            <input type="password" class="form-control" id="confirm" placeholder="Password" value=""/>
                          </div>

                          <div class="form-group">
                            <label for="exampleInputPassword1">role</label>
                            <input type="text" class="form-control" id="role" placeholder="role" value=""/>
                          </div>
                          
                          <button type="button" class="btn btn-primary mr-2" onclick="addUser()">Add</button>

                        </form>
                      </div>
                    </div>
                  </div>

                   <div class="col-md-8 grid-margin stretch-card">
                    <div class="card">
                      <div class="card-body">
                        <h4 class="card-title">User Information</h4>
                        <hr>
                        <p class="card-description">All Users : </p>
                        <table class="table">
                          <thead class="thead-dark">
                            <tr>
                              <th scope="col">Username</th>
                              <th scope="col">Password</th>
                              <th scope="col">Role</th>
                              
                            </tr>
                          </thead>
                          <tbody>
                           
                            {% for user in users %}
                                <tr>
                                  <td>{{user.username}}</td>
                                  <td>{{user.password}}</td>
                                  <td>{{user.role}}</td>
                                  <td><input type="button" class="btn btn-primary" value="Delete"></td>
                                </tr>
                            {% endfor %} 
                           
                           
                            
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

             
              
            </div>
          </div>
          <footer class="footer">
            <div class="d-sm-flex justify-content-center justify-content-sm-between">
              <span class="text-muted d-block text-center text-sm-left d-sm-inline-block">Copyright Â© Retail Store 2023</span>
            </div>
          </footer>
        </div>
        <!-- main-panel ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    

    <script src="{{ url_for('static', filename='js/vendor.bundle.base.js') }}?v=0.0.1"></script>
    <script src="{{ url_for('static', filename='js/select2.min.js') }}?v=0.0.1"></script>

    <script>
       function scrolltodiv(divid){
          var headerposition=document.getElementById('pageheader').offsetTop;
          document.getElementById('infocontainer').scrollTop = document.getElementById(divid).offsetTop-headerposition-100;
        }

      function callapi(method,url,jsondata,origin){
          var result=""

          const xhttpr = new XMLHttpRequest();
          xhttpr.open(method,url, true);

          if(method=="GET"){
            xhttpr.send();
          }else{
            xhttpr.setRequestHeader("Content-Type", "application/json");

            xhttpr.send(jsondata);
          }

          xhttpr.onreadystatechange = () => {
            if(xhttpr.status===200 && xhttpr.readyState === XMLHttpRequest.DONE){
              if(origin=='owner'){
                  result=xhttpr.response
                  console.log(result)
                  window.location.href='/owner'
              }else if(role=='manager'){
                    window.location.href='/manager'
              }else if(role=='supplier'){
                    window.location.href='/supplier'
              }else if(role=='employee'){
                    window.location.href='/employee'
              }else if(role=='customer'){
                 window.location.href='/customer'
              }

            }
          }

          return result
        }



        function addUser(){
          //capture the username and password
          var username=document.getElementById('username').value;
          var password=document.getElementById('password').value;
          var confirm=document.getElementById('confirm').value;
          var role=document.getElementById('role').value;

          if(password==confirm){
            var jsondata={
            'username': username,
            'password': password,
            'role': role,
            }

            jsondata=JSON.stringify(jsondata)

            //call the login endpoints
            callapi('POST','http://127.0.0.1:105/api/adduser',jsondata,'owner')

          }else{
            document.getElementById('userlog').innerHTML="Password do not match. Re-enter";
            document.getElementById('userlog').style.color="red"
            document.getElementById('password').value=""
            document.getElementById('confirm').value=""
          }
        }




  

       

    </script>

    
  </body>
</html>